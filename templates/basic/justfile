# -*-Makefile-*-

# Needed to make `"$@"` usable in recipes
set positional-arguments := true

default:
  just run --beam-on 10

test:
  meson setup build/test test
  meson compile -C build/test
  meson install -C build/test
  ./install/test/bin/CHANGEME-my-n4-test

build:
  meson setup build/app src
  meson compile -C build/app
  meson install -C build/app

run *ARGS: build
  #!/usr/bin/env sh
  sh execute-with-nixgl-if-needed.sh ./install/app/bin/CHANGEME-my-n4-prog "$@"
  exit $?

clean:
  rm build install -rf
